<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Kostory - Buat Faktur</title>
  <style>
    body{background:#f8f9fa;font-family:'Segoe UI',sans-serif;margin:0;padding:20px}
    .container{max-width:900px;margin:auto;background:#fff;padding:30px;border-radius:15px;box-shadow:0 8px 30px rgba(0,0,0,.1)}
    h1{font-size:46px;color:#ff9800;text-align:center;margin:0}
    .tagline{text-align:center;color:#777;margin:5px 0 20px;font-size:14px}
    .form-grid{display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px}
    .full{grid-column:1/-1}
    label{display:block;margin:15px 0 6px;font-weight:600;color:#333}
    input,select{width:100%;padding:12px;border:1px solid #ddd;border-radius:8px;font-size:15px;box-sizing:border-box}
    button{padding:12px 24px;border:none;border-radius:8px;cursor:pointer;font-weight:bold;margin:10px 5px 0 0}
    .btn-orange{background:#ff9800;color:#fff}
    .btn-green{background:#4caf50;color:#fff}
    .btn-red{background:#f44336;color:#fff}
    .btn-print{background:#ff5722;color:#fff;font-size:18px;padding:16px 50px}
    .highlight{background:#fff8e1;padding:15px;border-radius:8px;text-align:center;font-size:20px;font-weight:bold;margin:20px 0}
    .dropdown{position:relative}
    .dropdown-list{position:absolute;top:100%;left:0;right:0;background:#fff;border:1px solid #ddd;max-height:200px;overflow-y:auto;z-index:10;border-radius:8px;box-shadow:0 4px 15px rgba(0,0,0,.1)}
    .dropdown-item{padding:12px;cursor:pointer;border-bottom:1px solid #eee}
    .dropdown-item:hover{background:#fff8e1}
    .bank-item{display:flex;justify-content:space-between;align-items:center;padding:10px;background:#f9f9f9;margin:5px 0;border-radius:6px}
  </style>

  <!-- Firebase langsung di sini biar tidak 404 lagi -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getDatabase, ref, set, get, push, remove, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDaFM8dTqOn6c875Xe3VIfYkz4O1ioOLxA",
      authDomain: "nota-1596b.firebaseapp.com",
      databaseURL: "https://nota-1596b-default-rtdb.asia-southeast1.firebasedatabase.app",
      projectId: "nota-1596b",
      storageBucket: "nota-1596b.firebasestorage.app",
      messagingSenderId: "921988782142",
      appId: "1:921988782142:web:ac633cf89b0b002df5196f"
    };

    const app = initializeApp(firebaseConfig);
    window.db = getDatabase(app);
    window.dbRef = ref;
    window.dbSet = set;
    window.dbGet = get;
    window.dbPush = push;
    window.dbRemove = remove;
    window.dbOnValue = onValue;
  </script>
</head>
<body>
<div class="container">
  <h1>Kostory</h1>
  <p class="tagline">WHERE STORIES FIND HOME</p>
  <p style="text-align:center">Selamat datang, <strong><span id="user">Admin</span></strong> | <a href="login.html">Logout</a></p>
  <hr style="margin:30px 0">

  <form id="fakturForm">
    <div class="full">
      <label>Pilih Pelanggan</label>
      <div class="dropdown">
        <input type="text" id="searchCustomer" placeholder="-- Ketik nama atau HP --" autocomplete="off">
        <div id="customerDropdown" class="dropdown-list" style="display:none"></div>
      </div>
      <button type="button" class="btn-orange" onclick="openNewCustomer()">+ Baru</button>
    </div>

    <div id="newCustomerForm" style="display:none;background:#f0f8ff;padding:20px;border-radius:10px;margin:20px 0">
      <div class="form-grid">
        <div><label>Nama</label><input type="text" id="newNama"></div>
        <div><label>Kota</label><input type="text" id="newKota"></div>
        <div><label>No. HP</label><input type="text" id="newHp"></div>
        <div><label>Perusahaan</label><input type="text" id="newPerusahaan"></div>
      </div>
      <button type="button" class="btn-green" onclick="simpanPelangganBaru()">Save Pelanggan</button>
      <button type="button" onclick="document.getElementById('newCustomerForm').style.display='none'">Batal</button>
    </div>

    <div class="highlight full">
      No. Faktur: <strong><span id="noFaktur">251101</span></strong>
    </div>

    <div class="form-grid">
      <div><label>Tanggal Faktur</label><input type="date" id="tglFaktur" required></div>
      <div><label>Jatuh Tempo</label><input type="date" id="jatuhTempo" required></div>
    </div>

    <label>Tipe Kamar</label>
    <select id="tipeKamar" required>
      <option value="">-- Pilih Tipe --</option>
      <option>Single Bed Standard</option>
      <option>Double Bed Standard</option>
      <option>Single Bed Xtra Service</option>
      <option>Double Bed Xtra Service</option>
    </select>

    <label>Nama Kamar</label>
    <input type="text" id="namaKamar" placeholder="MEKAR 208" required>

    <div class="form-grid">
      <div><label>Check-in</label><input type="date" id="checkIn" required></div>
      <div><label>Check-out</label><input type="date" id="checkOut" required></div>
    </div>

    <label>Total Tagihan</label>
    <input type="number" id="totalTagihan" value="1950000" required>

    <label>Jumlah Dibayar</label>
    <input type="number" id="jumlahDibayar" value="0">

    <label>Rekening Bank</label>
    <select id="rekeningBank"></select>
    <button type="button" class="btn-orange" onclick="openBankManager()">+ Tambah Rekening</button>

    <div id="bankManager" style="display:none;margin-top:15px;padding:15px;background:#fff8e1;border-radius:8px">
      <input type="text" id="newBank" placeholder="BANK MANDIRI - 119-000-6262-842 - Y TEKAT HERI SUSANTO, ST" style="width:100%;padding:10px">
      <button type="button" class="btn-green" onclick="tambahBank()">Tambah</button>
      <div id="daftarBank" style="margin-top:15px"></div>
    </div>

    <div class="full" style="text-align:center;margin:40px 0">
      <button type="submit" class="btn-orange" style="padding:16px 50px;font-size:18px">SIMPAN FAKTUR</button>
      <button type="button" class="btn-print" onclick="cetakFaktur()">CETAK FAKTUR</button>
    </div>
  </form>
</div>

<script type="module" src="script.js"></script>
</body>
</html>
