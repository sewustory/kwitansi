<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Faktur Kostory</title>
  <style>
    @page { margin: 1cm; }
    body { font-family: Arial, sans-serif; margin: 0; padding: 20px; font-size: 13px; line-height: 1.5; color: #000; }
    .container { max-width: 900px; margin: auto; }
    .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 30px; }
    .logo { width: 100px; }
    .logo img { width: 100%; border-radius: 50%; }
    .title { font-size: 48px; font-weight: bold; margin-top: 10px; }
    .tagline { font-size: 11px; color: #666; margin-top: -5px; }
    .contact { text-align: right; font-size: 12px; line-height: 1.6; }
    .billto { background: #f5f5f5; padding: 15px; border-radius: 8px; margin: 25px 0; font-size: 14px; }
    .billto strong { font-size: 16px; }
    .info { float: right; font-size: 13px; margin-top: -50px; }
    table { width: 100%; border-collapse: collapse; margin: 40px 0; font-size: 13px; }
    th { background: #333; color: white; padding: 12px; text-align: left; }
    td { padding: 12px; border-bottom: 1px solid #ddd; }
    .text-center { text-align: center; }
    .text-right { text-align: right; }
    .total { font-weight: bold; font-size: 14px; }
    .highlight {
      border: 3px solid #000;
      padding: 20px;
      text-align: center;
      font-size: 24px;
      font-weight: bold;
      border-radius: 12px;
      max-width: 500px;
      margin: 40px auto;
    }
    .footer { margin-top: 60px; font-size: 12px; line-height: 1.8; }
    pre { background: #f9f9f9; padding: 15px; border-radius: 6px; font-size: 13px; white-space: pre-wrap; }
    @media print { body { padding: 10px; } .highlight { border: 3px solid #000; } }
  </style>
</head>
<body>
<div class="container">
  <div class="header">
    <div>
      <div class="logo"><img src="assets/logo-kostory.png" alt="Kostory"></div>
      <div class="title">Kostory</div>
      <div class="tagline">WHERE STORIES FIND HOME</div>
    </div>
    <div class="contact">
      Kostory Palembang<br>
      Jl. H Sanusi Lr.Mekar 1 No.888<br>
      Sukabangun - Sukarami<br>
      Kota Palembang<br>
      0813-8321-0009<br>
      kostory888@gmail.com
    </div>
  </div>

  <div class="billto">
    <strong>DITAGIH KEPADA</strong><br>
    <span id="perusahaan"></span>
    <span id="nama"></span><br>
    <span id="alamat"></span><br>
    <span id="hp"></span> <span id="pic"></span>
  </div>

  <div class="info">
    Faktur # <span id="noFaktur"></span><br>
    Tanggal <span id="tglFaktur"></span><br>
    Jatuh Tempo <span id="jatuhTempo"></span>
  </div>
  <div style="clear:both;"></div>

  <table>
    <thead>
      <tr>
        <th>Keterangan</th>
        <th class="text-center">Vol</th>
        <th class="text-right">Harga</th>
        <th class="text-right">Jumlah</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          Biaya Kost (<span id="tipeKamar"></span>)<br>
          <strong><span id="namaKamar"></span></strong><br>
          <span id="periode"></span>
        </td>
        <td class="text-center">1</td>
        <td class="text-right" id="harga"></td>
        <td class="text-right" id="jumlah"></td>
      </tr>
    </tbody>
  </table>

  <div style="text-align:right; margin-top:20px;">
    <div class="total">Subtotal <span id="subtotal"></span></div>
    <div class="total">Total <span id="total"></span></div>
    <div>Pembayaran <span id="pembayaran">Rp0</span></div>
  </div>

  <div class="highlight">
    Jumlah yang Harus Dibayar<br>
    <span id="harusDibayar" style="font-size:32px;">Rp1.950.000</span>
  </div>

  <div class="footer">
    <strong>Rek. Pembayaran :</strong><br>
    <pre id="rekBank"></pre>
    <span id="statusBayar">(Belum ada pembayaran)</span>
    <br><br>
    Harap melunasi pembayaran perpanjangan 3 hari sebelum masa sewa habis.<br>
    Segera info minimal 7 hari sebelum masa sewa habis jika tidak diperpanjang.<br>
    Biaya sewa kost tidak bisa direfund sebagian/seluruhnya apabila ada pembatalan saat masa sewa (early Checkout).<br><br>
    Terimakasih.
  </div>
</div>

<script>
  const params = new URLSearchParams(location.search);
  const data = JSON.parse(decodeURIComponent(params.get('data')));

  const rupiah = n => "Rp" + parseInt(n).toLocaleString('id-ID') + ",00";
  const tgl = d => new Date(d).toLocaleDateString('id-ID', {day:'numeric', month:'long', year:'numeric'});

  document.getElementById("noFaktur").textContent = data.noFaktur;
  document.getElementById("tglFaktur").textContent = tgl(data.tglFaktur);
  document.getElementById("jatuhTempo").textContent = tgl(data.jatuhTempo);
  document.getElementById("perusahaan").innerHTML = data.perusahaan ? data.perusahaan.toUpperCase() + "<br>" : "";
  document.getElementById("nama").textContent = data.nama.toUpperCase();
  document.getElementById("alamat").textContent = data.alamat;
  document.getElementById("hp").textContent = data.hp;
  document.getElementById("pic").textContent = data.perusahaan ? "MR GUO ZHIHUI â€“ MR BADANG SATRIO" : "";
  document.getElementById("tipeKamar").textContent = data.tipeKamar;
  document.getElementById("namaKamar").textContent = data.namaKamar;
  document.getElementById("periode").textContent = tgl(data.checkIn) + " SD " + tgl(data.checkOut);

  const total = data.totalTagihan;
  const bayar = data.jumlahDibayar || 0;
  const sisa = total - bayar;

  document.getElementById("harga").textContent = rupiah(total);
  document.getElementById("jumlah").textContent = rupiah(total);
  document.getElementById("subtotal").textContent = rupiah(total);
  document.getElementById("total").textContent = rupiah(total);
  document.getElementById("pembayaran").textContent = rupiah(bayar);
  document.getElementById("harusDibayar").textContent = rupiah(sisa);
  document.getElementById("rekBank").textContent = data.rekText || "BANK MANDIRI\n119-000-6262-842\nY TEKAT HERI SUSANTO, ST";

  if (bayar > 0) document.getElementById("statusBayar").textContent = "";

  setTimeout(() => window.print(), 1000);
</script>
</body>
</html>
