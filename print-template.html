<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Faktur {{noFaktur}}</title>
  <style>
    @page { margin: 0.5cm; }
    body { font-family: Arial, Helvetica, sans-serif; margin: 0; padding: 30px 50px; background: white; color: #000; }
    .header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 30px; }
    .logo img { width: 120px; }
    .logo-text { font-size: 48px; font-weight: bold; color: #000; margin-left: -10px; }
    .tagline { font-size: 11px; color: #666; margin-top: -5px; }
    .contact { text-align: right; font-size: 11px; line-height: 1.4; }
    .bill-box { border: 1px solid #ddd; padding: 15px; background: #f9f9f9; margin: 20px 0; font-size: 13px; }
    .bill-box strong { font-size: 14px; }
    .info-right { text-align: right; font-size: 13px; margin-top: -50px; }
    table { width: 100%; border-collapse: collapse; margin: 30px 0; font-size: 13px; }
    th, td { border: 1px solid #000; padding: 10px; text-align: left; }
    th { background: #333; color: white; }
    .text-center { text-align: center; }
    .text-right { text-align: right; }
    .total-section { font-size: 14px; line-height: 2; margin-top: 20px; }
    .highlight-box { border: 2px solid #000; padding: 15px; text-align: center; font-size: 20px; font-weight: bold; margin: 30px 0; width: 400px; margin-left: auto; }
    .footer { margin-top: 50px; font-size: 11px; line-height: 1.6; }
    pre { font-family: Arial; white-space: pre-wrap; font-size: 12px; }
    .no-print { display: none; }
  </style>
</head>
<body>

  <div class="header">
    <div>
      <div class="logo">
        <img src="assets/logo-kostory.png" alt="Kostory">
      </div>
      <div class="logo-text">Kostory</div>
      <div class="tagline">WHERE STORIES FIND HOME</div>
    </div>
    <div class="contact">
      Kostory Palembang<br>
      Jl. H Sanusi Lr.Mekar 1 No.888<br>
      Sukabangun - Sukarami<br>
      Kota Palembang<br>
      0813-8321-0009<br>
      kostory888@gmail.com
    </div>
  </div>

  <div class="bill-box">
    <strong>DITAGIH KEPADA</strong><br>
    <span id="perusahaan"></span><br>
    <span id="nama"></span><br>
    <span id="alamat"></span><br>
    <span id="hp"></span> <span id="pic"></span>
  </div>

  <div class="info-right">
    Faktur # <span id="noFaktur"></span><br>
    Tanggal <span id="tglFaktur"></span><br>
    Jatuh Tempo <span id="jatuhTempo"></span>
  </div>

  <table>
    <thead>
      <tr>
        <th>Keterangan</th>
        <th class="text-center">Vol</th>
        <th class="text-right">Harga</th>
        <th class="text-right">Jumlah</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          Biaya Kost (<span id="tipeKamar"></span>)<br>
          <span id="namaKamar"></span><br>
          <span id="periode"></span>
        </td>
        <td class="text-center">1</td>
        <td class="text-right" id="harga"></td>
        <td class="text-right" id="jumlah"></td>
      </tr>
    </tbody>
  </table>

  <div style="float: right; width: 300px;" class="total-section">
    <div>Subtotal <span id="subtotal" style="float:right"></span></div>
    <div><strong>Total</strong> <span id="total" style="float:right"></span></div>
    <div>Pembayaran <span id="pembayaran" style="float:right"></span></div>
  </div>
  <div style="clear:both;"></div>

  <div class="highlight-box">
    Jumlah yang Harus Dibayar<br>
    <span id="harusDibayar"></span>
  </div>

  <div class="footer">
    <strong>Rek. Pembayaran :</strong><br>
    <pre id="rekBank"></pre>
    <span id="statusBayar">(Belum ada pembayaran)</span>
    <br><br>
    Harap melunasi pembayaran perpanjangan 3 hari sebelum masa sewa habis.<br>
    Segera info minimal 7 hari sebelum masa sewa habis jika tidak diperpanjang.<br>
    Biaya sewa kost tidak bisa direfund sebagian/seluruhnya apabila ada pembatalan saat masa sewa (early Checkout).<br><br>
    Terimakasih.
  </div>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const data = JSON.parse(decodeURIComponent(urlParams.get('data')));

    const rupiah = (n) => "Rp" + parseInt(n).toLocaleString('id-ID') + ",00";

    document.getElementById("noFaktur").textContent = data.noFaktur;
    document.getElementById("tglFaktur").textContent = new Date(data.tglFaktur).toLocaleDateString('id-ID', {day:'numeric', month:'long', year:'numeric'});
    document.getElementById("jatuhTempo").textContent = new Date(data.jatuhTempo).toLocaleDateString('id-ID', {day:'numeric', month:'long', year:'numeric'});
    document.getElementById("perusahaan").textContent = data.perusahaan.toUpperCase() || '';
    document.getElementById("nama").textContent = data.nama.toUpperCase();
    document.getElementById("alamat").textContent = data.alamat;
    document.getElementById("hp").textContent = data.hp;
    document.getElementById("pic").textContent = data.perusahaan ? "– MR GUO ZHIHUI – MR BADANG SATRIO" : "";
    document.getElementById("tipeKamar").textContent = data.tipeKamar;
    document.getElementById("namaKamar").textContent = data.namaKamar;
    
    const inDate = new Date(data.checkIn).toLocaleDateString('id-ID', {day:'numeric', month:'long', year:'numeric'});
    const outDate = new Date(data.checkOut).toLocaleDateString('id-ID', {day:'numeric', month:'long', year:'numeric'});
    document.getElementById("periode").textContent = inDate + " SD " + outDate;

    const total = data.totalTagihan;
    const bayar = data.jumlahDibayar || 0;
    const sisa = total - bayar;

    document.getElementById("harga").textContent = rupiah(total);
    document.getElementById("jumlah").textContent = rupiah(total);
    document.getElementById("subtotal").textContent = rupiah(total);
    document.getElementById("total").textContent = rupiah(total);
    document.getElementById("pembayaran").textContent = rupiah(bayar);
    document.getElementById("harusDibayar").textContent = rupiah(sisa);

    if (bayar > 0) {
      document.getElementById("statusBayar").textContent = "";
    }

    // Rekening
    document.getElementById("rekBank").textContent = data.rekText || `BANK MANDIRI\n119-000-6262-842\nY TEKAT HERI SUSANTO, ST`;

    // Auto print
    window.onload = () => setTimeout(() => window.print(), 800);
  </script>
</body>
</html>